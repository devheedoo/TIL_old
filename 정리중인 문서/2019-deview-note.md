# 2019 Deview Note

## React, Angular, Vue를 한 번에 지원하기 위한 설계: Cross Framework Component

> [발표자료 PPT 링크](https://deview.kr/data/deview/2019/presentation/[224]+React,+Angular,+Vue를+한+번에+지원하기+위한+설계-191025.pdf)

나중에 멋진 JavaScript 오픈소스 라이브러리를 만들고 가꾸어나가는게 꿈이다. 그런 점에서 이 강연은 오랜만에 의지를 불태우고 감탄하게 만들었다.

요즘은 JavaScript 라이브러리를 만들더라도 오픈소스로 지원하려면 어려움이 있다. React, Angular, Vue 등의 프레임워크를 사용하는게 보편화되어 사용자들이 해당 프레임워크에서도 지원이 가능하길 바라기 때문이다.

렌더링과 관련된 DOM의 추가/삭제 또는 DOM의 순서 변경이 필요한 경우, 프레임워크별로 추가적인 작업이 필요하다. 그렇지 않으면 프레임워크 고유의 렌더링 메커니즘과 엉켜서 기대한 동작이 나타나지 않을 수 있기 때문이다. 이와 관련해 발표자께서는 2가지 경험을 예시를 들어주셨다. react-infinitegrid와 react-flicking이다.

**react-infinitegrid**: 프레임워크별로 코드를 작성해서 Vanilla, React, Angular, Vue, 총 4개의 서로 다르지만 같은 내용의 코드가 만들어졌다. 이렇게 할 경우 코드의 양도 많아지며 유지보수 시 매번 프레임워크별 코드를 수정해줘야 했다.

**react-flicking**: 단순하게 래핑하여 작성했다. 정확히 이해하진 못했지만 이 경우 내부 변수를 접근해야 하고, 추후에 내부 변수가 변경될 경우 또다시 코드를 변경해야 하고, DOM의 추가/삭제/이동이 어려웠다.

결국 이러한 문제점들을 해결하기 위해 프레임워크들의 공통점을 찾았다. **DOM의 key** 값을 기준으로 계산해서 렌더링한다는 것이다. 그 결과는 removed, maintained, added, 총 3 종류로 나타낼 수 있다. 그래서 이들의 key 값 기준으로 diff 하는 메커니즘을 공통으로 감싸 **ListDiffer** 모듈을 만들었다. 이를 이용해 프레임워크와 사용하더라도 DOM 조작을 외부화하고, 추가/삭제 메서드를 통해 데이터를 동기화하여 CFC를 구현했다.

여기에서 추가로 recycle 개념을 소개하며 단순히 DOM이 추가되는게 아니라 개수를 유지하면서 추가/삭제하는 경우 CFC의 사용방법을 설명해주셨다. 알찬 수업이었다.

이 라이브러리는 [egjs](https://github.com/naver/egjs)라는 이름으로 네이버 GitHub에서 관리중이다.

